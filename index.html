// ... 위 코드 생략 ...

        // 위치 기반 미션 좌표 (예: 서울 종로구 근처)
        const locationMissions = [
            {
                name: "경복궁",
                lat: 37.5796,
                lng: 126.9770,
                radius: 150, // 미터 단위
                mission: "경복궁 앞에서 궁궐의 기운을 느껴보세요 👑"
            },
            {
                name: "한강 공원",
                lat: 37.5207,
                lng: 126.9396,
                radius: 200,
                mission: "한강변을 따라 산책하며 강바람을 느껴보세요 🌊"
            }
        ];

        function checkProximityMission(currentLat, currentLng) {
            for (const spot of locationMissions) {
                const dist = calculateDistance(currentLat, currentLng, spot.lat, spot.lng);
                if (dist <= spot.radius) {
                    missionOutput.textContent = spot.mission;
                    document.getElementById('missionStatus').textContent = `${spot.name} 미션`; 
                    return true;
                }
            }
            return false;
        }

        generateMissionBtn.addEventListener('click', () => {
            const latest = path[path.length - 1];
            if (!latest) return;
            const [currLat, currLng] = latest.latlng;

            const locationMatched = checkProximityMission(currLat, currLng);
            if (!locationMatched) {
                const randomIndex = Math.floor(Math.random() * missions.length);
                const selected = missions[randomIndex];
                missionOutput.textContent = selected;
                document.getElementById('missionStatus').textContent = '랜덤 미션';
            }
        });
